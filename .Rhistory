select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(mean = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_colour_gradient2(midpoint = mean, mid = "white", high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(mean = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_colour_gradient2(midpoint = mean, high = muted("blue"), low = muted("red"), mid = "white")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(mean = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_color_gradient()
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(mean = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2()
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(mean = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2(midpoint = mean)
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(mean = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2(midpoint = mean %>% as.numeric())
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(mean = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2(midpoint = .mean)
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(mean = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2(midpoint = mean)
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2(midpoint = average)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance))
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2(midpoint = 67574)
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 90)) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45)) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -1)) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.5)) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.1)) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.1)) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.1),
legend.position = "top") +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.1),
legend.position = "top") +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.1),
legend.position = "top",
legend.key.width = 5) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
knitr::opts_chunk$set(echo = TRUE)
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.1),
legend.position = "top") +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.1),
legend.position = "top",
legend.key.width = unit(3, "cm")) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
#Who are each team's biggest rivals?  (This is the the team with the most average attendance vs a team)
attendance %>%
select(-team) %>%
mutate(week = as.character(week)) %>%
left_join(games %>% select(year, week, home_team_name, away_team_name), by = c("team_name" = "home_team_name", "year" = "year", "week" = "week")) %>%
drop_na() %>%
select(home = team_name, away = away_team_name, year, week, weekly_attendance) %>%
group_by(home) %>%
mutate(average_attendance = mean(weekly_attendance)) %>%
group_by(home, away) %>%
mutate(rival_attendance = mean(weekly_attendance)) %>%
select(home, away, average_attendance, rival_attendance) %>%
arrange(home) %>%
unique() %>%
ungroup() %>%
mutate(average = mean(rival_attendance)) %>%
ggplot(aes(x = home, y= away, fill = rival_attendance)) +
geom_tile() +
scale_x_discrete(position = "top") +
theme(axis.text.x = element_text(angle = 45, hjust = -.1),
legend.position = "top",
legend.key.width = unit(3, "cm")) +
scale_fill_gradient2(midpoint = 67574, high = "blue", low = "red")
