select(value, question, answer) %>%
mutate(value = if_else(value %in% c("0", "1", "2"), "Non-Frequent", "Frequent")) %>%
group_by(value, question) %>%
unnest_tokens("word", "answer", token = "words") %>%
group_by(question) %>%
add_count(word) %>%
bind_tf_idf(word, value, n) %>%
ungroup() %>%
select(value, question, word, tf_idf) %>%
filter(tf_idf != 0) %>%
left_join(df %>% select(question, question_explanation))
df %>%
filter(question_explanation == "In the past 12 months how many live music performances or concerts in the Cedar Rapids/ Iowa City area have you attended?") %>%
select(question_explanation, value, contains("_TEXT")) %>%
gather(key = "question", value = "answer", -question_explanation, -value) %>%
mutate(answer = str_squish(answer)) %>%
filter(!is.na(answer)) %>%
select(value, question, answer) %>%
mutate(value = if_else(value %in% c("0", "1", "2"), "Non-Frequent", "Frequent")) %>%
group_by(value, question) %>%
unnest_tokens("word", "answer", token = "words") %>%
group_by(question) %>%
add_count(word) %>%
bind_tf_idf(word, value, n) %>%
ungroup() %>%
select(value, question, word, tf_idf) %>%
filter(tf_idf != 0) %>%
left_join(df %>% select(question, question_explanation)) %>%
select(question_explanation, question, value, word, tf_idf)
df %>%
filter(question_explanation == "In the past 12 months how many live music performances or concerts in the Cedar Rapids/ Iowa City area have you attended?") %>%
select(question_explanation, value, contains("_TEXT")) %>%
gather(key = "question", value = "answer", -question_explanation, -value) %>%
mutate(answer = str_squish(answer)) %>%
filter(!is.na(answer)) %>%
select(value, question, answer) %>%
mutate(value = if_else(value %in% c("0", "1", "2"), "Non-Frequent", "Frequent")) %>%
group_by(value, question) %>%
unnest_tokens("word", "answer", token = "words") %>%
group_by(question) %>%
add_count(word) %>%
bind_tf_idf(word, value, n) %>%
ungroup() %>%
select(value, question, word, tf_idf) %>%
filter(tf_idf != 0) %>%
left_join(df %>% select(question, question_explanation)) %>%
select(question_explanation, question, value, word, tf_idf) %>%
write.csv("tf_idf.csv", row.names = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
game_goals <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-03/game_goals.csv')
top_250 <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-03/top_250.csv')
season_goals <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-03/season_goals.csv')
setwd("~/R work/Tidy-Tuesday")
game_goals %>%
glimpse()
season_goals %>%
glimpse()
top_250 %>%
glimpse()
game_goals %>%
glimpse()
season_goals %>% glimpse()
top_250 %>% glimpse()
game_goals %>%
select(season, game_num, goals, assists)
game_goals %>%
select(season, game_num, player, goals, assists)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
summarise(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
summarise(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
group_by(player) %>%
top_n(total_goals_per_season, n = 5)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
summarise(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
group_by(player)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
summarise(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup()
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
summarise(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
count(player)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
summarise(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup()
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
summarise(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
gather(key = "key", value = "value", -player, -season)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup()
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists)
gather(key = "key", value = "value", -season, -game_num, -player
game_goals %>%
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists) %>%
pivot_longer(values_to = c("total_goals_per_season", "total_assists_per_season"))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists) %>%
gather(key = "key", value = "value", -season, -game_num, -player)
?separate
mutate(season_game = union(c("season", "game_num"))
game_goals %>%
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists) %>%
gather(key = "key", value = "value", -season, -game_num, -player) %>%
mutate(season_game = unite(c("season", "game_num")))
?unite
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists) %>%
gather(key = "key", value = "value", -season, -game_num, -player)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists) %>%
gather(key = "key", value = "value", -season, -game_num, -player) %>%
unite("season_game", c("season", "game_num"), sep = "-")
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists) %>%
gather(key = "key", value = "value", -season, -game_num, -player) %>%
unite("season_game", c("season", "game_num"), sep = "-") %>%
group_by(player, key) %>%
mutate(season_game = fct_reorder(season_game, fun = row_number))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists) %>%
gather(key = "key", value = "value", -season, -game_num, -player) %>%
unite("season_game", c("season", "game_num"), sep = "-") %>%
group_by(player, key) %>%
mutate(row = row_number())
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
gather(key = "key", value = "value", -season, -player) %>%
unite("season_game", c("season", "game_num"), sep = "-") %>%
group_by(player, key) %>%
mutate(row = row_number())
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
gather(key = "key", value = "value", -season, -player)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
gather(key = "key", value = "value", -season, -player)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
gather(key = "key", value = "value", -season, -player) %>%
ggplot(aes(x = season, y = value, color = player)) + geom_smooth() + geom_point() + facet_wrap(~key, scales = "free")
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
gather(key = "key", value = "value", -season, -player) %>%
ggplot(aes(x = season, y = value, color = player)) +
geom_smooth() +
geom_point() +
facet_wrap(~key, scales = "free") +
theme(legend.position = "top")
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
gather(key = "key", value = "value", -season, -player)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique()
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
mutate(player = fct_lump(total_goals, prop = .05))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(player = fct_lump(total_goals, prop = .05))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup()
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup()%>%
mutate(player = fct_lump(prop = .05, w total_goals))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup()%>%
mutate(player = fct_lump(prop = .05, w = total_goals))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup()%>%
mutate(player = fct_lump(player, prop = .05, w = total_goals))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup()%>%
mutate(player = fct_lump(player, prop = .05, w = total_goals)) %>%
group_by(player) %>%
summarise(mean = mean(total_goals))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup()
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goalsx_per_season)) %>%
ungroup()
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup()
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(rank = min_rank(total_goals))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(rank = dplyr::dense_rank(total_goals))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(rank = dplyr::dense_rank(total_goals)) %>%
select(player, total_gaos, rank)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(rank = dplyr::dense_rank(total_goals)) %>%
select(player, total_goals, rank)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(rank = dplyr::dense_rank(total_goals)) %>%
select(player, total_goals, rank) %>%
unique() %>%
arrange(tank)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(rank = dplyr::dense_rank(total_goals)) %>%
select(player, total_goals, rank) %>%
unique() %>%
arrange(rank)
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_goals)))
game_goals %>%
select(season, game_num, player, goals, assists) %>%
group_by(player, season) %>%
mutate(total_goals_per_season = sum(goals),
total_assists_per_season = sum(assists)) %>%
ungroup() %>%
select(-goals,-assists, -game_num) %>%
unique() %>%
group_by(player) %>%
mutate(total_goals = sum(total_goals_per_season)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_goals)))
?pluck
game_goals
season_goals
