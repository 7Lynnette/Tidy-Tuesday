geom_hline(yintercept = .05, color = "red", linetype = "dashed") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(features) %>%
summarise(mean = mean(value))
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value))
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
ggplot(aes(x = musickey, y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
facet_wrap(~features, scales = "free")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value))
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = musickey, y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
facet_wrap(~features, scales = "free")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = musickey, y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = musickey, y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
coord_flip()
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = musickey, y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features), y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features), y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
tidytext::scale_x_reordered() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, -mean, features), y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
tidytext::scale_x_reordered() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = musickey, y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
tidytext::scale_x_reordered() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::scale_x_reordered(musickey, mean, features) , y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
tidytext::scale_x_reordered() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, color = musickey)) +
geom_point() +
geom_segment(aes(xend = musickey, yend = 0)) +
tidytext::scale_x_reordered() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, color = musickey)) +
geom_col() +
tidytext::scale_x_reordered() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col() +
tidytext::scale_x_reordered() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col() +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 3) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, position = "dodge2") +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, position = "dodge") +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, position = position_dodge(width = .2)) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, position = position_dodge(width = .5)) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, position = position_dodge(width = .75)) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, position = position_dodge(width = .9)) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, width = 3) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, width = .5) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1, width = 1) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
```{r, fig.width=10,fig.height=11}
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
```{r, fig.width=11, fig.height=5}
spotifyDf %>%
select(-mode) %>%
rename(., "musickey" = key) %>%
gather(key = "features", value = "value", -musickey) %>%
group_by(musickey,features) %>%
summarise(mean = mean(value)) %>%
mutate(mean = if_else(features == "loudness", -mean, mean)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, mean, features) , y = mean, fill = musickey)) +
geom_col(size = 1) +
tidytext::scale_x_reordered() +
coord_flip() +
facet_wrap(~features, scales = "free") +
theme(legend.position = "none")
```{r, fig.width = 5, fig.height= 5}
spotifyDf %>%
select(-key, -mode, -minutes) %>%
as.matrix() %>%
cor()
spotifyDf %>%
select(-key, -mode, -minutes) %>%
as.matrix() %>%
cor() %>%
corrplot::corrplot.mixed()
```{r, fig.width = 8, fig.height= 5}
#Analyzing relationship of spotify features, are danceaility and energy correlated? What about valence (happieness)?
spotifyDf %>%
select(-key, -mode, -minutes) %>%
as.matrix() %>%
cor() %>%
corrplot::corrplot.mixed()
spotifyDf %>%
select(-key, -mode, -minutes) %>%
as.matrix() %>%
cor()
spotifyDf %>%
select(-key, -mode, -minutes) %>%
as.matrix() %>%
cor() %>%
corrplot::corrplot.mixed()
spotifyDf %>%
select(-key, -mode, -minutes) %>%
as.matrix() %>%
cor() %>%
corrplot::corrplot.mixed()
spotifyDf %>%
select(-key, -mode, -minutes) %>%
as.matrix() %>%
cor()
spotifyDf %>%
select(-minutes, -tempo, -loudness) %>%
rename("musickey" = key, "major" = mode) %>%
mutate(major = if_else(major == 1, "major", "minor")) %>%
gather(key = "key", value = "value", -musickey,-major) %>%
arrange(major, musickey, key, value) %>%
ggplot(aes(x = value, fill = key, group = key)) +
geom_density(alpha = .5) +
scale_x_sqrt() +
scale_y_sqrt() +
facet_grid(musickey~major, scales = "free")
#Looking at playlist genre and their subgenre
df %>%
select(playlist_genre, playlist_subgenre) %>%
count(playlist_genre, playlist_subgenre) %>%
ggplot(aes(x = reorder(playlist_subgenre, -n), y = n, fill = playlist_genre)) +
geom_col() +
coord_flip() +
facet_wrap(~playlist_genre, scales = "free") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
#Is major better than minor?
spotifyDf %>%
mutate(mode = if_else(mode == 1, "Major", "Minor")) %>%
select(-key) %>%
gather(key = "key", value = "value", -mode) %>%
group_by(mode) %>%
ggplot(aes(x = mode, y = value, fill = key)) +
geom_boxplot() +
facet_wrap(~key, scales = "free")
spotifyDf %>%
rename("musickey" = key) %>%
mutate(mode = if_else(mode == 1, "Major", "Minor")) %>%
gather(key = "key", value = "value", -musickey,-mode) %>%
group_by(musickey, mode, key) %>%
summarise(mean = mean(value)) %>%
ggplot(aes(x = musickey, y = mean, fill = key)) +
geom_col() +
facet_wrap(~key+ mode, scales = "free") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
spotifyDf %>%
rename("musickey" = key) %>%
mutate(mode = if_else(mode == 1, "Major", "Minor")) %>%
gather(key = "key", value = "value", -musickey,-mode) %>%
group_by(musickey, mode, key) %>%
summarise(mean = mean(value)) %>%
ggplot(aes(x = tidytest::reorder_within(musickey, -mean, key), y = mean, fill = key)) +
geom_col() +
tidytext::scale_x_reordered() +
facet_wrap(~key+ mode, scales = "free") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
spotifyDf %>%
rename("musickey" = key) %>%
mutate(mode = if_else(mode == 1, "Major", "Minor")) %>%
gather(key = "key", value = "value", -musickey,-mode) %>%
group_by(musickey, mode, key) %>%
summarise(mean = mean(value)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, -mean, key), y = mean, fill = key)) +
geom_col() +
tidytext::scale_x_reordered() +
facet_wrap(~key+ mode, scales = "free") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
spotifyDf %>%
rename("musickey" = key) %>%
mutate(mode = if_else(mode == 1, "Major", "Minor")) %>%
gather(key = "key", value = "value", -musickey,-mode) %>%
group_by(musickey, mode, key) %>%
summarise(mean = mean(value)) %>%
ggplot(aes(x = tidytext::reorder_within(musickey, -mean, key, mode), y = mean, fill = key)) +
geom_col() +
tidytext::scale_x_reordered() +
facet_wrap(~key + mode, scales = "free") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
spotifyDf %>%
rename("musickey" = key) %>%
mutate(mode = if_else(mode == 1, "Major", "Minor")) %>%
gather(key = "key", value = "value", -musickey,-mode) %>%
group_by(musickey, mode, key) %>%
summarise(mean = mean(value)) %>%
ggplot(aes(x = musickey, y = mean, fill = key)) +
geom_col() +
facet_wrap(~key + mode, scales = "free") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
spotifyDf %>%
rename("musickey" = key) %>%
mutate(mode = if_else(mode == 1, "Major", "Minor")) %>%
gather(key = "key", value = "value", -musickey,-mode) %>%
group_by(musickey, mode, key) %>%
summarise(mean = mean(value)) %>%
ggplot(aes(x = musickey, y = mean, fill = musickey)) +
geom_col() +
facet_wrap(~key + mode, scales = "free") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
#Let's make a better plot by looking at the means of each key and its relative mode and spotify features
spotifyDf %>%
rename("musickey" = key) %>%
mutate(mode = if_else(mode == 1, "Major", "Minor")) %>%
gather(key = "key", value = "value", -musickey,-mode) %>%
group_by(musickey, mode, key) %>%
summarise(mean = mean(value)) %>%
ggplot(aes(x = musickey, y = mean, fill = musickey)) +
geom_col() +
coord_flip() +
facet_wrap(~key + mode, scales = "free") +
theme(axis.text.x = element_text(angle = 90),
legend.position = "none")
