ungroup() %>%
mutate(key = fct_reorder(key, -value)) %>%
ggplot(aes(x = key, y = value)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0))
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = fct_reorder(key, -value)) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0))
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = fct_reorder(key, -value)) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("Avg Flavour Profile") +
xlab("")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = fct_reorder(key, -value)) %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("Avg Flavour Profile") +
xlab("")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = fct_reorder(key, -value)) %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("") +
xlab("")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
mutate(key = fct_reorder(key, -value)) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("") +
xlab("") +
labs(title = "Avg Flavour Profile")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
mutate(key = fct_reorder(key, -value)) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("") +
xlab("") +
coord_flip() +
labs(title = "Avg Flavour Profile")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
mutate(key = fct_reorder(key, value)) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("") +
xlab("") +
coord_flip() +
labs(title = "Avg Flavour Profile")
coffee_ratings %>%
select(country_of_origin, variety)
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(variety) %>%
drop_na()
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(variety) %>%
drop_na() %>%
count(variety)
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(variety) %>%
drop_na() %>%
count(variety) %>%
mutate(variety = fct_reorder(variety, n)) %>%
ggplot(aes(x = n, y = variety)) +
geom_col()
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(variety) %>%
drop_na() %>%
count(variety) %>%
mutate(variety = fct_reorder(variety, n)) %>%
ggplot(aes(x = n, y = variety)) +
geom_col() +
ylab("") +
labs(title = "Bean Variety")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(variety) %>%
drop_na() %>%
count(variety) %>%
mutate(variety = fct_reorder(variety, n)) %>%
ggplot(aes(x = n, y = variety, fill = variety)) +
geom_col() +
ylab("") +
labs(title = "Bean Variety")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(variety) %>%
drop_na() %>%
count(variety) %>%
mutate(variety = fct_reorder(variety, n)) %>%
ggplot(aes(x = n, y = variety, fill = variety)) +
geom_col() +
ylab("") +
labs(title = "Bean Variety") +
theme(legend.position = "none")
coffee_ratings
coffee_ratings %>%
filter(country_of_origin == "Ethiopia")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region)
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
arrange(desc(total_cup_points))
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
mutate(region = str_trunc(region)) %>%
arrange(desc(total_cup_points))
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
mutate(region = str_trunc(region, 8, right)) %>%
arrange(desc(total_cup_points))
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
mutate(region = str_trunc(region, 8, "right")) %>%
arrange(desc(total_cup_points))
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
mutate(region = str_trunc(region, 10, "right")) %>%
arrange(desc(total_cup_points))
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
mutate(region = str_trunc(region, 12, "right")) %>%
arrange(desc(total_cup_points))
install.packages("kableExtra")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
mutate(region = str_trunc(region, 12, "right")) %>%
arrange(desc(total_cup_points))
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
mutate(region = str_trunc(region, 12, "right")) %>%
arrange(desc(total_cup_points)) %>%
kable()
library(kableExtra)
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(total_cup_points, species, country_of_origin, region) %>%
group_by(species, region) %>%
top_n(total_cup_points, n = 1) %>%
ungroup() %>%
mutate(region = str_trunc(region, 12, "right")) %>%
arrange(desc(total_cup_points)) %>%
kable()
coffee_ratings
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points)
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight"))
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin)
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight)
library(broom)
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight)
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy())
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test)
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
ggplot(aes(x = key, y = estimate, color = key)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high))
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
ggplot(aes(x = key, y = estimate, color = key)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) +
geom_hline(yintercept = 0, linetype = "dashed") +
coord_flip() +
theme(legend.position = "none")
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
mutate(differenct = case_when(
conf.low < 0 & conf.high < 0 ~ "Different",
conf.low > 0 & conf.high > 0 ~ "Different",
TRUE ~ "Not-Different"
))
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
mutate(differenct = case_when(
conf.low < 0 & conf.high < 0 ~ "Different",
conf.low > 0 & conf.high > 0 ~ "Different",
TRUE ~ "Not-Different"
)) %>%
ggplot(aes(x = key, y = estimate, color = key)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) +
geom_hline(yintercept = 0, linetype = "dashed") +
coord_flip() +
theme(legend.position = "none")
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
mutate(diffference = case_when(
conf.low < 0 & conf.high < 0 ~ "Different",
conf.low > 0 & conf.high > 0 ~ "Different",
TRUE ~ "Not-Different"
)) %>%
ggplot(aes(x = key, y = estimate, color = diffference)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) +
geom_hline(yintercept = 0, linetype = "dashed") +
coord_flip() +
theme(legend.position = "none")
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
mutate(diffference = case_when(
conf.low < 0 & conf.high < 0 ~ "Different",
conf.low > 0 & conf.high > 0 ~ "Different",
TRUE ~ "Not-Different"
)) %>%
ggplot(aes(x = key, y = estimate, color = diffference)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) +
geom_hline(yintercept = 0, linetype = "dashed") +
coord_flip() +
theme(legend.position = "none") +
xlab("")
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
mutate(diffference = case_when(
conf.low < 0 & conf.high < 0 ~ "Different",
conf.low > 0 & conf.high > 0 ~ "Different",
TRUE ~ "Not-Different"
)) %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
ggplot(aes(x = key, y = estimate, color = diffference)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) +
geom_hline(yintercept = 0, linetype = "dashed") +
coord_flip() +
theme(legend.position = "none") +
xlab("") +
labs(title = "How different are the flavour profiles?")
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
mutate(diffference = case_when(
conf.low < 0 & conf.high < 0 ~ "Different",
conf.low > 0 & conf.high > 0 ~ "Different",
TRUE ~ "Not-Different"
)) %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
mutate(key = fct_reorder(key, estimate)) %>%
ggplot(aes(x = key, y = estimate, color = diffference)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) +
geom_hline(yintercept = 0, linetype = "dashed") +
coord_flip() +
theme(legend.position = "none") +
xlab("") +
labs(title = "How different are the flavour profiles?")
coffee_ratings %>%
select(country_of_origin, aroma:cupper_points) %>%
mutate(highlight = if_else(country_of_origin == "Ethiopia", "Highlight", "No-Highlight")) %>%
select(-country_of_origin) %>%
gather(key = "key", value = "value", -highlight) %>%
group_by(key) %>%
do(t_test = t.test(value~highlight, data = .) %>% tidy()) %>%
unnest(t_test) %>%
mutate(diffference = case_when(
conf.low < 0 & conf.high < 0 ~ "Different",
conf.low > 0 & conf.high > 0 ~ "Different",
TRUE ~ "Not-Different"
)) %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
mutate(key = fct_reorder(key, -estimate)) %>%
ggplot(aes(x = key, y = estimate, color = diffference)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) +
geom_hline(yintercept = 0, linetype = "dashed") +
coord_flip() +
theme(legend.position = "none") +
xlab("") +
labs(title = "How different are the flavour profiles?")
install.packages("shinydashboard")
shiny::runApp('Coffee')
library(shiny)
library(shinydashboard)
library(tidyverse)
library(broom)
library(kableExtra)
library(shiny)
library(shinydashboard)
library(tidyverse)
library(broom)
library(kableExtra)
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
mutate(key = fct_reorder(key, value)) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("") +
xlab("") +
labs(title = "Avg Flavour Profile")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
mutate(key = fct_reorder(key, value)) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("") +
xlab("") +
labs(title = "Avg Flavour Profile")
coffee_ratings %>%
filter(country_of_origin == "Ethiopia") %>%
select(aroma:cupper_points) %>%
gather() %>%
group_by(key) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
mutate(key = str_replace(key, "_", " ") %>% str_to_title()) %>%
mutate(key = fct_reorder(key, value)) %>%
ggplot(aes(x = key, y = value, color = key)) +
geom_point(size = 5) +
geom_segment(aes(x = key, xend = key, y = value, yend = 0)) +
theme(legend.position = "none") +
ylab("") +
xlab("") +
coord_flip() +
labs(title = "Avg Flavour Profile")
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
runApp('Coffee')
